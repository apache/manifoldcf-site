<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.4) on Sat Oct 28 11:39:32 EDT 2023 -->
<title>ConnectionBin</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2023-10-28">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ConnectionBin";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":9,"i1":9,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":9,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":9,"i15":9,"i16":10,"i17":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ConnectionBin.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.apache.manifoldcf.connectorcommon.throttler</a></div>
<h2 title="Class ConnectionBin" class="title">Class ConnectionBin</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.manifoldcf.connectorcommon.throttler.ConnectionBin</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre>public class <span class="typeNameLabel">ConnectionBin</span>
extends java.lang.Object</pre>
<div class="block">Connection tracking for a bin.

 This class keeps track of information needed to figure out throttling for connections,
 on a bin-by-bin basis.  It is *not*, however, a connection pool.  Actually establishing
 connections, and pooling established connections, is functionality that must reside in the
 caller.

 The 'connections' each connection bin tracks are connections outstanding that share this bin name.
 Not all such connections are identical; some may in fact have entirely different sets of
 bins associated with them, but they all have the specific bin in common.  Since each bin has its
 own unique limit, this effectively means that in order to get a connection, you need to find an
 available slot in ALL of its constituent connection bins.  If the connections are pooled, it makes
 the most sense to divide the pool up by characteristics such that identical connections are all
 handled together - and it is reasonable to presume that an identical connection has identical
 connection bins.

 NOTE WELL: This is entirely local in operation</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="ConnectionBin.SumClass.html" title="class in org.apache.manifoldcf.connectorcommon.throttler">ConnectionBin.SumClass</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#binName">binName</a></span></code></th>
<td class="colLast">
<div class="block">This is the bin name which this connection pool belongs to</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#CONNECTION_DESTROY">CONNECTION_DESTROY</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#CONNECTION_POOLEMPTY">CONNECTION_POOLEMPTY</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#CONNECTION_WITHINBOUNDS">CONNECTION_WITHINBOUNDS</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#inUseConnections">inUseConnections</a></span></code></th>
<td class="colLast">
<div class="block">This is the number of connections in this bin that are connected; immaterial whether they are
 in use or in a pool somewhere.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isAlive">isAlive</a></span></code></th>
<td class="colLast">
<div class="block">True if this bin is alive still</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#localMax">localMax</a></span></code></th>
<td class="colLast">
<div class="block">This is the local maximum number of active connections allowed for this bin</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#maxActiveConnections">maxActiveConnections</a></span></code></th>
<td class="colLast">
<div class="block">This is the maximum number of active connections allowed for this bin</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static java.util.Random</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#randomNumberGenerator">randomNumberGenerator</a></span></code></th>
<td class="colLast">
<div class="block">Random number</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#referencingPools">referencingPools</a></span></code></th>
<td class="colLast">
<div class="block">This is the number of active referring connection pools.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#reservedConnections">reservedConnections</a></span></code></th>
<td class="colLast">
<div class="block">This is the number of connections in this bin that have been reserved - that is, they
 are promised to various callers, but those callers have not yet committed to obtaining them.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#serviceName">serviceName</a></span></code></th>
<td class="colLast">
<div class="block">The (anonymous) service name</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#serviceTypeName">serviceTypeName</a></span></code></th>
<td class="colLast">
<div class="block">Service type name</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#serviceTypePrefix">serviceTypePrefix</a></span></code></th>
<td class="colLast">
<div class="block">The service type prefix for connection bins</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#targetCalcLockName">targetCalcLockName</a></span></code></th>
<td class="colLast">
<div class="block">The target calculation lock name</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#targetCalcLockPrefix">targetCalcLockPrefix</a></span></code></th>
<td class="colLast">
<div class="block">The target calculation lock prefix</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(org.apache.manifoldcf.core.interfaces.IThreadContext,java.lang.String,java.lang.String)">ConnectionBin</a></span>&#8203;(<a href="../../core/interfaces/IThreadContext.html" title="interface in org.apache.manifoldcf.core.interfaces">IThreadContext</a>&nbsp;threadContext,
             java.lang.String&nbsp;throttlingGroupName,
             java.lang.String&nbsp;binName)</code></th>
<td class="colLast">
<div class="block">Constructor.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#buildServiceTypeName(java.lang.String,java.lang.String)">buildServiceTypeName</a></span>&#8203;(java.lang.String&nbsp;throttlingGroupName,
                    java.lang.String&nbsp;binName)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#buildTargetCalcLockName(java.lang.String,java.lang.String)">buildTargetCalcLockName</a></span>&#8203;(java.lang.String&nbsp;throttlingGroupName,
                       java.lang.String&nbsp;binName)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getBinName()">getBinName</a></span>()</code></th>
<td class="colLast">
<div class="block">Get the bin name.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#hasPooledConnection(java.util.concurrent.atomic.AtomicInteger)">hasPooledConnection</a></span>&#8203;(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</code></th>
<td class="colLast">
<div class="block">Check only if there's a pooled connection, and make moves to take it from the pool.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#noteConnectionCreation()">noteConnectionCreation</a></span>()</code></th>
<td class="colLast">
<div class="block">Note the creation of an active connection that belongs to this bin.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#noteConnectionDestroyed()">noteConnectionDestroyed</a></span>()</code></th>
<td class="colLast">
<div class="block">Note the destruction of an active connection that belongs to this bin.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#noteConnectionReturnedToPool(java.util.concurrent.atomic.AtomicInteger)">noteConnectionReturnedToPool</a></span>&#8203;(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</code></th>
<td class="colLast">
<div class="block">Note a connection returned to the pool.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>protected static byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#pack(int,int)">pack</a></span>&#8203;(int&nbsp;target,
    int&nbsp;inUse)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#poll(org.apache.manifoldcf.core.interfaces.IThreadContext)">poll</a></span>&#8203;(<a href="../../core/interfaces/IThreadContext.html" title="interface in org.apache.manifoldcf.core.interfaces">IThreadContext</a>&nbsp;threadContext)</code></th>
<td class="colLast">
<div class="block">Poll this bin</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#shouldPooledConnectionBeDestroyed(java.util.concurrent.atomic.AtomicInteger)">shouldPooledConnectionBeDestroyed</a></span>&#8203;(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</code></th>
<td class="colLast">
<div class="block">Figure out whether we are currently over target or not for this bin, and whether a
 connection should be pulled from the pool and destroyed.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#shouldReturnedConnectionBeDestroyed()">shouldReturnedConnectionBeDestroyed</a></span>()</code></th>
<td class="colLast">
<div class="block">Figure out whether we are currently over target or not for this bin.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#shutDown(org.apache.manifoldcf.core.interfaces.IThreadContext)">shutDown</a></span>&#8203;(<a href="../../core/interfaces/IThreadContext.html" title="interface in org.apache.manifoldcf.core.interfaces">IThreadContext</a>&nbsp;threadContext)</code></th>
<td class="colLast">
<div class="block">Shut down the bin, and release everything that is waiting on it.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#undoPooledConnectionDecision(java.util.concurrent.atomic.AtomicInteger)">undoPooledConnectionDecision</a></span>&#8203;(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</code></th>
<td class="colLast">
<div class="block">Undo the decision to destroy a pooled connection.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#undoReservation(int,java.util.concurrent.atomic.AtomicInteger)">undoReservation</a></span>&#8203;(int&nbsp;recommendation,
               java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</code></th>
<td class="colLast">
<div class="block">Undo what we had decided to do before.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>protected static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#unpackInUse(byte%5B%5D)">unpackInUse</a></span>&#8203;(byte[]&nbsp;data)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>protected static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#unpackTarget(byte%5B%5D)">unpackTarget</a></span>&#8203;(byte[]&nbsp;data)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#updateMaxActiveConnections(int)">updateMaxActiveConnections</a></span>&#8203;(int&nbsp;maxActiveConnections)</code></th>
<td class="colLast">
<div class="block">Update the maximum number of active connections.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#waitConnectionAvailable(java.util.concurrent.atomic.AtomicInteger,org.apache.manifoldcf.connectorcommon.interfaces.IBreakCheck)">waitConnectionAvailable</a></span>&#8203;(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount,
                       <a href="../interfaces/IBreakCheck.html" title="interface in org.apache.manifoldcf.connectorcommon.interfaces">IBreakCheck</a>&nbsp;breakCheck)</code></th>
<td class="colLast">
<div class="block">Wait for a connection to become available, in the context of an existing connection pool.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="isAlive">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isAlive</h4>
<pre>protected&nbsp;boolean isAlive</pre>
<div class="block">True if this bin is alive still</div>
</li>
</ul>
<a id="binName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>binName</h4>
<pre>protected final&nbsp;java.lang.String binName</pre>
<div class="block">This is the bin name which this connection pool belongs to</div>
</li>
</ul>
<a id="serviceTypeName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>serviceTypeName</h4>
<pre>protected final&nbsp;java.lang.String serviceTypeName</pre>
<div class="block">Service type name</div>
</li>
</ul>
<a id="serviceName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>serviceName</h4>
<pre>protected final&nbsp;java.lang.String serviceName</pre>
<div class="block">The (anonymous) service name</div>
</li>
</ul>
<a id="targetCalcLockName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>targetCalcLockName</h4>
<pre>protected final&nbsp;java.lang.String targetCalcLockName</pre>
<div class="block">The target calculation lock name</div>
</li>
</ul>
<a id="maxActiveConnections">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>maxActiveConnections</h4>
<pre>protected&nbsp;int maxActiveConnections</pre>
<div class="block">This is the maximum number of active connections allowed for this bin</div>
</li>
</ul>
<a id="localMax">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>localMax</h4>
<pre>protected&nbsp;int localMax</pre>
<div class="block">This is the local maximum number of active connections allowed for this bin</div>
</li>
</ul>
<a id="reservedConnections">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reservedConnections</h4>
<pre>protected&nbsp;int reservedConnections</pre>
<div class="block">This is the number of connections in this bin that have been reserved - that is, they
 are promised to various callers, but those callers have not yet committed to obtaining them.</div>
</li>
</ul>
<a id="inUseConnections">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>inUseConnections</h4>
<pre>protected&nbsp;int inUseConnections</pre>
<div class="block">This is the number of connections in this bin that are connected; immaterial whether they are
 in use or in a pool somewhere.</div>
</li>
</ul>
<a id="referencingPools">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>referencingPools</h4>
<pre>protected&nbsp;int referencingPools</pre>
<div class="block">This is the number of active referring connection pools.  We increment this number
 whenever a poolCount goes from zero to 1, and we decrement it whenever a poolCount
 goes from one to zero.</div>
</li>
</ul>
<a id="serviceTypePrefix">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>serviceTypePrefix</h4>
<pre>protected static final&nbsp;java.lang.String serviceTypePrefix</pre>
<div class="block">The service type prefix for connection bins</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.manifoldcf.connectorcommon.throttler.ConnectionBin.serviceTypePrefix">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="targetCalcLockPrefix">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>targetCalcLockPrefix</h4>
<pre>protected static final&nbsp;java.lang.String targetCalcLockPrefix</pre>
<div class="block">The target calculation lock prefix</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.manifoldcf.connectorcommon.throttler.ConnectionBin.targetCalcLockPrefix">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="randomNumberGenerator">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>randomNumberGenerator</h4>
<pre>protected static final&nbsp;java.util.Random randomNumberGenerator</pre>
<div class="block">Random number</div>
</li>
</ul>
<a id="CONNECTION_DESTROY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CONNECTION_DESTROY</h4>
<pre>public static final&nbsp;int CONNECTION_DESTROY</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.manifoldcf.connectorcommon.throttler.ConnectionBin.CONNECTION_DESTROY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="CONNECTION_POOLEMPTY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CONNECTION_POOLEMPTY</h4>
<pre>public static final&nbsp;int CONNECTION_POOLEMPTY</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.manifoldcf.connectorcommon.throttler.ConnectionBin.CONNECTION_POOLEMPTY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="CONNECTION_WITHINBOUNDS">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CONNECTION_WITHINBOUNDS</h4>
<pre>public static final&nbsp;int CONNECTION_WITHINBOUNDS</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.manifoldcf.connectorcommon.throttler.ConnectionBin.CONNECTION_WITHINBOUNDS">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(org.apache.manifoldcf.core.interfaces.IThreadContext,java.lang.String,java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ConnectionBin</h4>
<pre>public&nbsp;ConnectionBin&#8203;(<a href="../../core/interfaces/IThreadContext.html" title="interface in org.apache.manifoldcf.core.interfaces">IThreadContext</a>&nbsp;threadContext,
                     java.lang.String&nbsp;throttlingGroupName,
                     java.lang.String&nbsp;binName)
              throws <a href="../../core/interfaces/ManifoldCFException.html" title="class in org.apache.manifoldcf.core.interfaces">ManifoldCFException</a></pre>
<div class="block">Constructor.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../core/interfaces/ManifoldCFException.html" title="class in org.apache.manifoldcf.core.interfaces">ManifoldCFException</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="buildServiceTypeName(java.lang.String,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildServiceTypeName</h4>
<pre class="methodSignature">protected static&nbsp;java.lang.String&nbsp;buildServiceTypeName&#8203;(java.lang.String&nbsp;throttlingGroupName,
                                                       java.lang.String&nbsp;binName)</pre>
</li>
</ul>
<a id="buildTargetCalcLockName(java.lang.String,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildTargetCalcLockName</h4>
<pre class="methodSignature">protected static&nbsp;java.lang.String&nbsp;buildTargetCalcLockName&#8203;(java.lang.String&nbsp;throttlingGroupName,
                                                          java.lang.String&nbsp;binName)</pre>
</li>
</ul>
<a id="getBinName()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBinName</h4>
<pre class="methodSignature">public&nbsp;java.lang.String&nbsp;getBinName()</pre>
<div class="block">Get the bin name.</div>
</li>
</ul>
<a id="updateMaxActiveConnections(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateMaxActiveConnections</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;updateMaxActiveConnections&#8203;(int&nbsp;maxActiveConnections)</pre>
<div class="block">Update the maximum number of active connections.</div>
</li>
</ul>
<a id="waitConnectionAvailable(java.util.concurrent.atomic.AtomicInteger,org.apache.manifoldcf.connectorcommon.interfaces.IBreakCheck)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>waitConnectionAvailable</h4>
<pre class="methodSignature">public&nbsp;int&nbsp;waitConnectionAvailable&#8203;(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount,
                                   <a href="../interfaces/IBreakCheck.html" title="interface in org.apache.manifoldcf.connectorcommon.interfaces">IBreakCheck</a>&nbsp;breakCheck)
                            throws java.lang.InterruptedException,
                                   <a href="../interfaces/BreakException.html" title="class in org.apache.manifoldcf.connectorcommon.interfaces">BreakException</a></pre>
<div class="block">Wait for a connection to become available, in the context of an existing connection pool.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>poolCount</code> - is the number of connections in the pool times the number of bins per connection.
 This parameter is only ever changed in this class!!</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a recommendation as to how to proceed, using the IConnectionThrottler values.  If the
 recommendation is to create a connection, a slot will be reserved for that purpose.  A
 subsequent call to noteConnectionCreation() will be needed to confirm the reservation, or clearReservation() to
 release the reservation.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code></dd>
<dd><code><a href="../interfaces/BreakException.html" title="class in org.apache.manifoldcf.connectorcommon.interfaces">BreakException</a></code></dd>
</dl>
</li>
</ul>
<a id="undoReservation(int,java.util.concurrent.atomic.AtomicInteger)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>undoReservation</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;undoReservation&#8203;(int&nbsp;recommendation,
                            java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</pre>
<div class="block">Undo what we had decided to do before.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>recommendation</code> - is the decision returned by waitForConnection() above.</dd>
</dl>
</li>
</ul>
<a id="noteConnectionCreation()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>noteConnectionCreation</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;noteConnectionCreation()</pre>
<div class="block">Note the creation of an active connection that belongs to this bin.  The connection MUST
 have been reserved prior to the connection being created.</div>
</li>
</ul>
<a id="shouldReturnedConnectionBeDestroyed()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shouldReturnedConnectionBeDestroyed</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;shouldReturnedConnectionBeDestroyed()</pre>
<div class="block">Figure out whether we are currently over target or not for this bin.</div>
</li>
</ul>
<a id="shouldPooledConnectionBeDestroyed(java.util.concurrent.atomic.AtomicInteger)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shouldPooledConnectionBeDestroyed</h4>
<pre class="methodSignature">public&nbsp;int&nbsp;shouldPooledConnectionBeDestroyed&#8203;(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</pre>
<div class="block">Figure out whether we are currently over target or not for this bin, and whether a
 connection should be pulled from the pool and destroyed.
 Note that this is tricky in conjunction with other bins, because those other bins
 may conclude that we can't destroy a connection.  If so, we just return the stolen
 connection back to the pool.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>CONNECTION_DESTROY, CONNECTION_POOLEMPTY, or CONNECTION_WITHINBOUNDS.</dd>
</dl>
</li>
</ul>
<a id="hasPooledConnection(java.util.concurrent.atomic.AtomicInteger)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasPooledConnection</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;hasPooledConnection&#8203;(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</pre>
<div class="block">Check only if there's a pooled connection, and make moves to take it from the pool.</div>
</li>
</ul>
<a id="undoPooledConnectionDecision(java.util.concurrent.atomic.AtomicInteger)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>undoPooledConnectionDecision</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;undoPooledConnectionDecision&#8203;(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</pre>
<div class="block">Undo the decision to destroy a pooled connection.</div>
</li>
</ul>
<a id="noteConnectionReturnedToPool(java.util.concurrent.atomic.AtomicInteger)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>noteConnectionReturnedToPool</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;noteConnectionReturnedToPool&#8203;(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</pre>
<div class="block">Note a connection returned to the pool.</div>
</li>
</ul>
<a id="noteConnectionDestroyed()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>noteConnectionDestroyed</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;noteConnectionDestroyed()</pre>
<div class="block">Note the destruction of an active connection that belongs to this bin.</div>
</li>
</ul>
<a id="poll(org.apache.manifoldcf.core.interfaces.IThreadContext)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>poll</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;poll&#8203;(<a href="../../core/interfaces/IThreadContext.html" title="interface in org.apache.manifoldcf.core.interfaces">IThreadContext</a>&nbsp;threadContext)
          throws <a href="../../core/interfaces/ManifoldCFException.html" title="class in org.apache.manifoldcf.core.interfaces">ManifoldCFException</a></pre>
<div class="block">Poll this bin</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../core/interfaces/ManifoldCFException.html" title="class in org.apache.manifoldcf.core.interfaces">ManifoldCFException</a></code></dd>
</dl>
</li>
</ul>
<a id="shutDown(org.apache.manifoldcf.core.interfaces.IThreadContext)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shutDown</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;shutDown&#8203;(<a href="../../core/interfaces/IThreadContext.html" title="interface in org.apache.manifoldcf.core.interfaces">IThreadContext</a>&nbsp;threadContext)
              throws <a href="../../core/interfaces/ManifoldCFException.html" title="class in org.apache.manifoldcf.core.interfaces">ManifoldCFException</a></pre>
<div class="block">Shut down the bin, and release everything that is waiting on it.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../core/interfaces/ManifoldCFException.html" title="class in org.apache.manifoldcf.core.interfaces">ManifoldCFException</a></code></dd>
</dl>
</li>
</ul>
<a id="unpackTarget(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unpackTarget</h4>
<pre class="methodSignature">protected static&nbsp;int&nbsp;unpackTarget&#8203;(byte[]&nbsp;data)</pre>
</li>
</ul>
<a id="unpackInUse(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unpackInUse</h4>
<pre class="methodSignature">protected static&nbsp;int&nbsp;unpackInUse&#8203;(byte[]&nbsp;data)</pre>
</li>
</ul>
<a id="pack(int,int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>pack</h4>
<pre class="methodSignature">protected static&nbsp;byte[]&nbsp;pack&#8203;(int&nbsp;target,
                             int&nbsp;inUse)</pre>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ConnectionBin.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
