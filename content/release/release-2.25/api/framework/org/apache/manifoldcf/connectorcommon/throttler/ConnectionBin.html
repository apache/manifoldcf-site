<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_181) on Mon May 29 16:36:56 EDT 2023 -->
<title>ConnectionBin</title>
<meta name="date" content="2023-05-29">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ConnectionBin";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":9,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":9,"i15":9,"i16":10,"i17":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ConnectionBin.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.SumClass.html" title="class in org.apache.manifoldcf.connectorcommon.throttler"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html" target="_top">Frames</a></li>
<li><a href="ConnectionBin.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.manifoldcf.connectorcommon.throttler</div>
<h2 title="Class ConnectionBin" class="title">Class ConnectionBin</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.manifoldcf.connectorcommon.throttler.ConnectionBin</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">ConnectionBin</span>
extends java.lang.Object</pre>
<div class="block">Connection tracking for a bin.

 This class keeps track of information needed to figure out throttling for connections,
 on a bin-by-bin basis.  It is *not*, however, a connection pool.  Actually establishing
 connections, and pooling established connections, is functionality that must reside in the
 caller.

 The 'connections' each connection bin tracks are connections outstanding that share this bin name.
 Not all such connections are identical; some may in fact have entirely different sets of
 bins associated with them, but they all have the specific bin in common.  Since each bin has its
 own unique limit, this effectively means that in order to get a connection, you need to find an
 available slot in ALL of its constituent connection bins.  If the connections are pooled, it makes
 the most sense to divide the pool up by characteristics such that identical connections are all
 handled together - and it is reasonable to presume that an identical connection has identical
 connection bins.

 NOTE WELL: This is entirely local in operation</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.SumClass.html" title="class in org.apache.manifoldcf.connectorcommon.throttler">ConnectionBin.SumClass</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#binName">binName</a></span></code>
<div class="block">This is the bin name which this connection pool belongs to</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#CONNECTION_DESTROY">CONNECTION_DESTROY</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#CONNECTION_POOLEMPTY">CONNECTION_POOLEMPTY</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#CONNECTION_WITHINBOUNDS">CONNECTION_WITHINBOUNDS</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#inUseConnections">inUseConnections</a></span></code>
<div class="block">This is the number of connections in this bin that are connected; immaterial whether they are
 in use or in a pool somewhere.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#isAlive">isAlive</a></span></code>
<div class="block">True if this bin is alive still</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#localMax">localMax</a></span></code>
<div class="block">This is the local maximum number of active connections allowed for this bin</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#maxActiveConnections">maxActiveConnections</a></span></code>
<div class="block">This is the maximum number of active connections allowed for this bin</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static java.util.Random</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#randomNumberGenerator">randomNumberGenerator</a></span></code>
<div class="block">Random number</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#referencingPools">referencingPools</a></span></code>
<div class="block">This is the number of active referring connection pools.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#reservedConnections">reservedConnections</a></span></code>
<div class="block">This is the number of connections in this bin that have been reserved - that is, they
 are promised to various callers, but those callers have not yet committed to obtaining them.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#serviceName">serviceName</a></span></code>
<div class="block">The (anonymous) service name</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#serviceTypeName">serviceTypeName</a></span></code>
<div class="block">Service type name</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#serviceTypePrefix">serviceTypePrefix</a></span></code>
<div class="block">The service type prefix for connection bins</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#targetCalcLockName">targetCalcLockName</a></span></code>
<div class="block">The target calculation lock name</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#targetCalcLockPrefix">targetCalcLockPrefix</a></span></code>
<div class="block">The target calculation lock prefix</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#ConnectionBin-org.apache.manifoldcf.core.interfaces.IThreadContext-java.lang.String-java.lang.String-">ConnectionBin</a></span>(<a href="../../../../../org/apache/manifoldcf/core/interfaces/IThreadContext.html" title="interface in org.apache.manifoldcf.core.interfaces">IThreadContext</a>&nbsp;threadContext,
             java.lang.String&nbsp;throttlingGroupName,
             java.lang.String&nbsp;binName)</code>
<div class="block">Constructor.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#buildServiceTypeName-java.lang.String-java.lang.String-">buildServiceTypeName</a></span>(java.lang.String&nbsp;throttlingGroupName,
                    java.lang.String&nbsp;binName)</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#buildTargetCalcLockName-java.lang.String-java.lang.String-">buildTargetCalcLockName</a></span>(java.lang.String&nbsp;throttlingGroupName,
                       java.lang.String&nbsp;binName)</code>&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#getBinName--">getBinName</a></span>()</code>
<div class="block">Get the bin name.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#hasPooledConnection-java.util.concurrent.atomic.AtomicInteger-">hasPooledConnection</a></span>(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</code>
<div class="block">Check only if there's a pooled connection, and make moves to take it from the pool.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#noteConnectionCreation--">noteConnectionCreation</a></span>()</code>
<div class="block">Note the creation of an active connection that belongs to this bin.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#noteConnectionDestroyed--">noteConnectionDestroyed</a></span>()</code>
<div class="block">Note the destruction of an active connection that belongs to this bin.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#noteConnectionReturnedToPool-java.util.concurrent.atomic.AtomicInteger-">noteConnectionReturnedToPool</a></span>(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</code>
<div class="block">Note a connection returned to the pool.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>protected static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#pack-int-int-">pack</a></span>(int&nbsp;target,
    int&nbsp;inUse)</code>&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#poll-org.apache.manifoldcf.core.interfaces.IThreadContext-">poll</a></span>(<a href="../../../../../org/apache/manifoldcf/core/interfaces/IThreadContext.html" title="interface in org.apache.manifoldcf.core.interfaces">IThreadContext</a>&nbsp;threadContext)</code>
<div class="block">Poll this bin</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#shouldPooledConnectionBeDestroyed-java.util.concurrent.atomic.AtomicInteger-">shouldPooledConnectionBeDestroyed</a></span>(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</code>
<div class="block">Figure out whether we are currently over target or not for this bin, and whether a
 connection should be pulled from the pool and destroyed.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#shouldReturnedConnectionBeDestroyed--">shouldReturnedConnectionBeDestroyed</a></span>()</code>
<div class="block">Figure out whether we are currently over target or not for this bin.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#shutDown-org.apache.manifoldcf.core.interfaces.IThreadContext-">shutDown</a></span>(<a href="../../../../../org/apache/manifoldcf/core/interfaces/IThreadContext.html" title="interface in org.apache.manifoldcf.core.interfaces">IThreadContext</a>&nbsp;threadContext)</code>
<div class="block">Shut down the bin, and release everything that is waiting on it.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#undoPooledConnectionDecision-java.util.concurrent.atomic.AtomicInteger-">undoPooledConnectionDecision</a></span>(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</code>
<div class="block">Undo the decision to destroy a pooled connection.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#undoReservation-int-java.util.concurrent.atomic.AtomicInteger-">undoReservation</a></span>(int&nbsp;recommendation,
               java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</code>
<div class="block">Undo what we had decided to do before.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>protected static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#unpackInUse-byte:A-">unpackInUse</a></span>(byte[]&nbsp;data)</code>&nbsp;</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>protected static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#unpackTarget-byte:A-">unpackTarget</a></span>(byte[]&nbsp;data)</code>&nbsp;</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#updateMaxActiveConnections-int-">updateMaxActiveConnections</a></span>(int&nbsp;maxActiveConnections)</code>
<div class="block">Update the maximum number of active connections.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html#waitConnectionAvailable-java.util.concurrent.atomic.AtomicInteger-org.apache.manifoldcf.connectorcommon.interfaces.IBreakCheck-">waitConnectionAvailable</a></span>(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount,
                       <a href="../../../../../org/apache/manifoldcf/connectorcommon/interfaces/IBreakCheck.html" title="interface in org.apache.manifoldcf.connectorcommon.interfaces">IBreakCheck</a>&nbsp;breakCheck)</code>
<div class="block">Wait for a connection to become available, in the context of an existing connection pool.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="isAlive">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isAlive</h4>
<pre>protected&nbsp;boolean isAlive</pre>
<div class="block">True if this bin is alive still</div>
</li>
</ul>
<a name="binName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>binName</h4>
<pre>protected final&nbsp;java.lang.String binName</pre>
<div class="block">This is the bin name which this connection pool belongs to</div>
</li>
</ul>
<a name="serviceTypeName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>serviceTypeName</h4>
<pre>protected final&nbsp;java.lang.String serviceTypeName</pre>
<div class="block">Service type name</div>
</li>
</ul>
<a name="serviceName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>serviceName</h4>
<pre>protected final&nbsp;java.lang.String serviceName</pre>
<div class="block">The (anonymous) service name</div>
</li>
</ul>
<a name="targetCalcLockName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>targetCalcLockName</h4>
<pre>protected final&nbsp;java.lang.String targetCalcLockName</pre>
<div class="block">The target calculation lock name</div>
</li>
</ul>
<a name="maxActiveConnections">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>maxActiveConnections</h4>
<pre>protected&nbsp;int maxActiveConnections</pre>
<div class="block">This is the maximum number of active connections allowed for this bin</div>
</li>
</ul>
<a name="localMax">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>localMax</h4>
<pre>protected&nbsp;int localMax</pre>
<div class="block">This is the local maximum number of active connections allowed for this bin</div>
</li>
</ul>
<a name="reservedConnections">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reservedConnections</h4>
<pre>protected&nbsp;int reservedConnections</pre>
<div class="block">This is the number of connections in this bin that have been reserved - that is, they
 are promised to various callers, but those callers have not yet committed to obtaining them.</div>
</li>
</ul>
<a name="inUseConnections">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>inUseConnections</h4>
<pre>protected&nbsp;int inUseConnections</pre>
<div class="block">This is the number of connections in this bin that are connected; immaterial whether they are
 in use or in a pool somewhere.</div>
</li>
</ul>
<a name="referencingPools">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>referencingPools</h4>
<pre>protected&nbsp;int referencingPools</pre>
<div class="block">This is the number of active referring connection pools.  We increment this number
 whenever a poolCount goes from zero to 1, and we decrement it whenever a poolCount
 goes from one to zero.</div>
</li>
</ul>
<a name="serviceTypePrefix">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>serviceTypePrefix</h4>
<pre>protected static final&nbsp;java.lang.String serviceTypePrefix</pre>
<div class="block">The service type prefix for connection bins</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.manifoldcf.connectorcommon.throttler.ConnectionBin.serviceTypePrefix">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="targetCalcLockPrefix">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>targetCalcLockPrefix</h4>
<pre>protected static final&nbsp;java.lang.String targetCalcLockPrefix</pre>
<div class="block">The target calculation lock prefix</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.manifoldcf.connectorcommon.throttler.ConnectionBin.targetCalcLockPrefix">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="randomNumberGenerator">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>randomNumberGenerator</h4>
<pre>protected static final&nbsp;java.util.Random randomNumberGenerator</pre>
<div class="block">Random number</div>
</li>
</ul>
<a name="CONNECTION_DESTROY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CONNECTION_DESTROY</h4>
<pre>public static final&nbsp;int CONNECTION_DESTROY</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.manifoldcf.connectorcommon.throttler.ConnectionBin.CONNECTION_DESTROY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="CONNECTION_POOLEMPTY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CONNECTION_POOLEMPTY</h4>
<pre>public static final&nbsp;int CONNECTION_POOLEMPTY</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.manifoldcf.connectorcommon.throttler.ConnectionBin.CONNECTION_POOLEMPTY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="CONNECTION_WITHINBOUNDS">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CONNECTION_WITHINBOUNDS</h4>
<pre>public static final&nbsp;int CONNECTION_WITHINBOUNDS</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.apache.manifoldcf.connectorcommon.throttler.ConnectionBin.CONNECTION_WITHINBOUNDS">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ConnectionBin-org.apache.manifoldcf.core.interfaces.IThreadContext-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ConnectionBin</h4>
<pre>public&nbsp;ConnectionBin(<a href="../../../../../org/apache/manifoldcf/core/interfaces/IThreadContext.html" title="interface in org.apache.manifoldcf.core.interfaces">IThreadContext</a>&nbsp;threadContext,
                     java.lang.String&nbsp;throttlingGroupName,
                     java.lang.String&nbsp;binName)
              throws <a href="../../../../../org/apache/manifoldcf/core/interfaces/ManifoldCFException.html" title="class in org.apache.manifoldcf.core.interfaces">ManifoldCFException</a></pre>
<div class="block">Constructor.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../org/apache/manifoldcf/core/interfaces/ManifoldCFException.html" title="class in org.apache.manifoldcf.core.interfaces">ManifoldCFException</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="buildServiceTypeName-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildServiceTypeName</h4>
<pre>protected static&nbsp;java.lang.String&nbsp;buildServiceTypeName(java.lang.String&nbsp;throttlingGroupName,
                                                       java.lang.String&nbsp;binName)</pre>
</li>
</ul>
<a name="buildTargetCalcLockName-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildTargetCalcLockName</h4>
<pre>protected static&nbsp;java.lang.String&nbsp;buildTargetCalcLockName(java.lang.String&nbsp;throttlingGroupName,
                                                          java.lang.String&nbsp;binName)</pre>
</li>
</ul>
<a name="getBinName--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBinName</h4>
<pre>public&nbsp;java.lang.String&nbsp;getBinName()</pre>
<div class="block">Get the bin name.</div>
</li>
</ul>
<a name="updateMaxActiveConnections-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateMaxActiveConnections</h4>
<pre>public&nbsp;void&nbsp;updateMaxActiveConnections(int&nbsp;maxActiveConnections)</pre>
<div class="block">Update the maximum number of active connections.</div>
</li>
</ul>
<a name="waitConnectionAvailable-java.util.concurrent.atomic.AtomicInteger-org.apache.manifoldcf.connectorcommon.interfaces.IBreakCheck-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>waitConnectionAvailable</h4>
<pre>public&nbsp;int&nbsp;waitConnectionAvailable(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount,
                                   <a href="../../../../../org/apache/manifoldcf/connectorcommon/interfaces/IBreakCheck.html" title="interface in org.apache.manifoldcf.connectorcommon.interfaces">IBreakCheck</a>&nbsp;breakCheck)
                            throws java.lang.InterruptedException,
                                   <a href="../../../../../org/apache/manifoldcf/connectorcommon/interfaces/BreakException.html" title="class in org.apache.manifoldcf.connectorcommon.interfaces">BreakException</a></pre>
<div class="block">Wait for a connection to become available, in the context of an existing connection pool.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>poolCount</code> - is the number of connections in the pool times the number of bins per connection.
 This parameter is only ever changed in this class!!</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a recommendation as to how to proceed, using the IConnectionThrottler values.  If the
 recommendation is to create a connection, a slot will be reserved for that purpose.  A
 subsequent call to noteConnectionCreation() will be needed to confirm the reservation, or clearReservation() to
 release the reservation.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code></dd>
<dd><code><a href="../../../../../org/apache/manifoldcf/connectorcommon/interfaces/BreakException.html" title="class in org.apache.manifoldcf.connectorcommon.interfaces">BreakException</a></code></dd>
</dl>
</li>
</ul>
<a name="undoReservation-int-java.util.concurrent.atomic.AtomicInteger-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>undoReservation</h4>
<pre>public&nbsp;void&nbsp;undoReservation(int&nbsp;recommendation,
                            java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</pre>
<div class="block">Undo what we had decided to do before.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>recommendation</code> - is the decision returned by waitForConnection() above.</dd>
</dl>
</li>
</ul>
<a name="noteConnectionCreation--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>noteConnectionCreation</h4>
<pre>public&nbsp;void&nbsp;noteConnectionCreation()</pre>
<div class="block">Note the creation of an active connection that belongs to this bin.  The connection MUST
 have been reserved prior to the connection being created.</div>
</li>
</ul>
<a name="shouldReturnedConnectionBeDestroyed--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shouldReturnedConnectionBeDestroyed</h4>
<pre>public&nbsp;boolean&nbsp;shouldReturnedConnectionBeDestroyed()</pre>
<div class="block">Figure out whether we are currently over target or not for this bin.</div>
</li>
</ul>
<a name="shouldPooledConnectionBeDestroyed-java.util.concurrent.atomic.AtomicInteger-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shouldPooledConnectionBeDestroyed</h4>
<pre>public&nbsp;int&nbsp;shouldPooledConnectionBeDestroyed(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</pre>
<div class="block">Figure out whether we are currently over target or not for this bin, and whether a
 connection should be pulled from the pool and destroyed.
 Note that this is tricky in conjunction with other bins, because those other bins
 may conclude that we can't destroy a connection.  If so, we just return the stolen
 connection back to the pool.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>CONNECTION_DESTROY, CONNECTION_POOLEMPTY, or CONNECTION_WITHINBOUNDS.</dd>
</dl>
</li>
</ul>
<a name="hasPooledConnection-java.util.concurrent.atomic.AtomicInteger-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasPooledConnection</h4>
<pre>public&nbsp;boolean&nbsp;hasPooledConnection(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</pre>
<div class="block">Check only if there's a pooled connection, and make moves to take it from the pool.</div>
</li>
</ul>
<a name="undoPooledConnectionDecision-java.util.concurrent.atomic.AtomicInteger-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>undoPooledConnectionDecision</h4>
<pre>public&nbsp;void&nbsp;undoPooledConnectionDecision(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</pre>
<div class="block">Undo the decision to destroy a pooled connection.</div>
</li>
</ul>
<a name="noteConnectionReturnedToPool-java.util.concurrent.atomic.AtomicInteger-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>noteConnectionReturnedToPool</h4>
<pre>public&nbsp;void&nbsp;noteConnectionReturnedToPool(java.util.concurrent.atomic.AtomicInteger&nbsp;poolCount)</pre>
<div class="block">Note a connection returned to the pool.</div>
</li>
</ul>
<a name="noteConnectionDestroyed--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>noteConnectionDestroyed</h4>
<pre>public&nbsp;void&nbsp;noteConnectionDestroyed()</pre>
<div class="block">Note the destruction of an active connection that belongs to this bin.</div>
</li>
</ul>
<a name="poll-org.apache.manifoldcf.core.interfaces.IThreadContext-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>poll</h4>
<pre>public&nbsp;void&nbsp;poll(<a href="../../../../../org/apache/manifoldcf/core/interfaces/IThreadContext.html" title="interface in org.apache.manifoldcf.core.interfaces">IThreadContext</a>&nbsp;threadContext)
          throws <a href="../../../../../org/apache/manifoldcf/core/interfaces/ManifoldCFException.html" title="class in org.apache.manifoldcf.core.interfaces">ManifoldCFException</a></pre>
<div class="block">Poll this bin</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../org/apache/manifoldcf/core/interfaces/ManifoldCFException.html" title="class in org.apache.manifoldcf.core.interfaces">ManifoldCFException</a></code></dd>
</dl>
</li>
</ul>
<a name="shutDown-org.apache.manifoldcf.core.interfaces.IThreadContext-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shutDown</h4>
<pre>public&nbsp;void&nbsp;shutDown(<a href="../../../../../org/apache/manifoldcf/core/interfaces/IThreadContext.html" title="interface in org.apache.manifoldcf.core.interfaces">IThreadContext</a>&nbsp;threadContext)
              throws <a href="../../../../../org/apache/manifoldcf/core/interfaces/ManifoldCFException.html" title="class in org.apache.manifoldcf.core.interfaces">ManifoldCFException</a></pre>
<div class="block">Shut down the bin, and release everything that is waiting on it.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../org/apache/manifoldcf/core/interfaces/ManifoldCFException.html" title="class in org.apache.manifoldcf.core.interfaces">ManifoldCFException</a></code></dd>
</dl>
</li>
</ul>
<a name="unpackTarget-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unpackTarget</h4>
<pre>protected static&nbsp;int&nbsp;unpackTarget(byte[]&nbsp;data)</pre>
</li>
</ul>
<a name="unpackInUse-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unpackInUse</h4>
<pre>protected static&nbsp;int&nbsp;unpackInUse(byte[]&nbsp;data)</pre>
</li>
</ul>
<a name="pack-int-int-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>pack</h4>
<pre>protected static&nbsp;byte[]&nbsp;pack(int&nbsp;target,
                             int&nbsp;inUse)</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ConnectionBin.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.SumClass.html" title="class in org.apache.manifoldcf.connectorcommon.throttler"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/manifoldcf/connectorcommon/throttler/ConnectionBin.html" target="_top">Frames</a></li>
<li><a href="ConnectionBin.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
